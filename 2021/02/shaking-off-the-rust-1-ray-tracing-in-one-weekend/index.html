<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0"
  />
  
  <meta property="og:title" content="Shaking Off the Rust 1: Ray Tracing in One Weekend" />
  <meta name="twitter:title" content="Shaking Off the Rust 1: Ray Tracing in One Weekend" />
  
  <title>Shaking Off the Rust 1: Ray Tracing in One Weekend - clayto</title>

  
  <meta name="description" content="Learning Rust, one tetanus shot at a time.  In this post, I work on building a Ray Tracer in Many Weekends." />
  <meta property="og:description" content="Learning Rust, one tetanus shot at a time.  In this post, I work on building a Ray Tracer in Many Weekends." />
  <meta name="twitter:description" content="Learning Rust, one tetanus shot at a time.  In this post, I work on building a Ray Tracer in Many Weekends." />
  

  <meta name="author" content="" />
  <meta property="og:site_name" content="clayto" />
  <meta property="og:url" content="https://clayto.com/2021/02/shaking-off-the-rust-1-ray-tracing-in-one-weekend/" />

  
  <meta property="og:image" content="https://clayto.com/2021/02/shaking-off-the-rust-1-ray-tracing-in-one-weekend/thumb.jpg" />
  <meta
    name="twitter:image"
    content="https://clayto.com/2021/02/shaking-off-the-rust-1-ray-tracing-in-one-weekend/thumb.jpg"
  />
  
  <meta name="twitter:card" content="summary" />

  
  <meta name="twitter:site" content="@mwcz" />
  <meta name="twitter:creator" content="@mwcz" />
   
  <meta property="og:type" content="article" />
   
  
  <meta name="generator" content="Hugo 0.81.0" /><link media="screen"
    href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600"
    rel="stylesheet"
  />
  <link media="screen" rel="stylesheet" href="https://clayto.com/css/styles.min.css" />

  
  <link
    rel="apple-touch-icon"
    sizes="180x180"
    href="https://clayto.com/images/favicons/apple-touch-icon.png?v=alQ2onMqbL"
  />
  <link
    rel="icon"
    type="image/png"
    sizes="32x32"
    href="https://clayto.com/images/favicons/favicon-32x32.png?v=alQ2onMqbL"
  />
  <link
    rel="icon"
    type="image/png"
    sizes="16x16"
    href="https://clayto.com/images/favicons/favicon-16x16.png?v=alQ2onMqbL"
  />
  <link rel="manifest" href="https://clayto.com/images/favicons/site.webmanifest?v=alQ2onMqbL" />
  <link
    rel="mask-icon"
    href="https://clayto.com/images/favicons/safari-pinned-tab.svg?v=alQ2onMqbL"
    color="#121212"
  />
  <link rel="shortcut icon" href="https://clayto.com/images/favicons/favicon.ico?v=alQ2onMqbL" />
  <meta name="msapplication-TileColor" content="#121212" />
  <meta
    name="msapplication-config"
    content="/images/favicons/browserconfig.xml?v=alQ2onMqbL"
  />
  <meta name="theme-color" content="#121212" />
   
  
  

</head>

<body>
  
  
  
  
  
  
  
  
  
  
  
  
<header class="pbp-navbar-container">
  
<nav class="pbp-navbar" role="navigation">
  <div class="pbp-nav-logo">
    <a href="https://clayto.com/" title="Home" id="pbp-logo">
      <img src="https://clayto.com/images/logo.png" height="50.4" width="50.4" alt="smiling clayto.com logo">
    </a>
  </div>
  <div class="pbp-navitems">
    
    
    
    <a href="https://clayto.com/" class="pbp-navitem">
      &nbsp;BLOG</a>
    
    &nbsp;<span class="pbp-nav-separator">&middot;</span>
    
    
    <a href="https://clayto.com/demos" class="pbp-navitem">
      &nbsp;DEMOS</a>
    
    &nbsp;<span class="pbp-nav-separator">&middot;</span>
    
    
    <a href="https://clayto.com/games" class="pbp-navitem">
      &nbsp;GAMES</a>
    
    
  </div>
</nav>




</header>
  <main id="main" role="main" class="container">


<article class="pbp-article">

  <header>
    <h1>Shaking Off the Rust 1: Ray Tracing in One Weekend</h1>
  </header>

  

  <div class="pbp-article-meta">
    <time datetime="2021-02-08T22:38:50-05:00">
      Feb 8, 2021
    </time>
    
    <span class="pbp-blue">&middot;</span>
    7 minute read
    <br>
    <span class="pbp-article-tags">
      
      <a href="https://clayto.com/tags/3d" class="c-tag">#3d</a>
      
      <a href="https://clayto.com/tags/programming" class="c-tag">#programming</a>
      
      <a href="https://clayto.com/tags/ray-tracing" class="c-tag">#ray-tracing</a>
      
      <a href="https://clayto.com/tags/rust" class="c-tag">#rust</a>
      
    </span>
  </div>

  
  
  <section>
    <p>Two classes stand out as my favorites from computer science at NCSU:  x86 assembly and computer graphics.  In the graphics course, we wrote a <a href="https://en.wikipedia.org/wiki/Rasterisation">rasterizer</a> and a <a href="https://en.wikipedia.org/wiki/Ray_tracing_(graphics)">ray tracer</a> (which I never finished 😅).</p>
<p>In the 16 years since, I&rsquo;ve been working happily in web development, but I&rsquo;ve started to lament losing touch with lower-level, nearer-metal (🤘) programming which captured my interest so much in college.</p>
<p>When I learned that my favorite CS lecturer, Dana Lasher, retired recently, I decided to start a fun side project in honor of him and the inspiration he gave me.</p>
<hr>
<h2 id="choosing-a-project">Choosing a project</h2>
<p>But what to do?  After some thought, there was only one choice: finish the ray tracer.</p>
<p>I dusted off my graphics projects from the class.  To my surprise, despite being compiled on Linux Mint in 2009, the rasterizer binary still ran on Fedora 34 in 2021!</p>
<div class="beside">
    <figure>
        <img src="./csc461/csc461_tor_sidebyside.png" alt="rasterizer running in 2009 on Linux Mint" loading="lazy" width=640 height=400>
        <figcaption>rasterizer on Linut Mint, 2009</figcaption>
    </figure>
    <figure>
        <img src="./csc461/csc461-fedora34.png" alt="rasterizer running in 2021 on Fedora 34" loading="lazy" width=503 height=377>
        <figcaption>rasterizer on Fedora 34, 2021</figcaption>
    </figure>
</div>
<p>It looks like the program grew a few artifacts in the intervening 12 years.  Bit rot, I guess. I&rsquo;m just impressed that it ran at all, having been written on another distro, 12 years prior, by a complete novice at C++.</p>
<p>The ray tracer is another story.  I didn&rsquo;t even try running it again because what I <em>did</em> write was horribly inefficient.  Here are some screenshots for evidence.</p>
<div class="beside">
    <figure>
        <picture>
          <source srcset="./csc461/test_view.avif" type="image/avif">
          <source srcset="./csc461/test_view.webp" type="image/webp">
          <img loading="lazy" src="./csc461/test_view.jpg" alt="Expected result" width=640 height=480>
        </picture>
        <figcaption>The reference image.  Yes, this is rasterized, not ray traced.  I don't know why.</figcaption>
    </figure>
    <figure>
        <img src="./csc461/not_right_totally_wrong.png" alt='Imagine with a single pixel rendered, named "not right totally wrong dot png"' loading="lazy" width=800 height=563 />
        <figcaption>One dot.</figcaption>
    </figure>
    <figure>
        <img src="./csc461/pass4.png" alt='a few more pixels'  loading="lazy" width=800 height=533 />
        <figcaption>A few dots.</figcaption>
    </figure>
    <figure>
        <img src="./csc461/overnight.png" alt='a speckled approximation of the expected result, named "overnight.png" because it took a ridiculous number of hours to complete' loading="lazy" width=357 height=262  />
        <figcaption>Closer, but the filename "overnight.png" says it all.</figcaption>
    </figure>
</div>
<p>The final image above is a tiny <code>200x130</code> pixels, with spotty ray coverage, and took over 8 hours to render.  That&rsquo;s <em>including</em> required optimizations like a <a href="https://en.wikipedia.org/wiki/K-d_tree">kd-tree</a> for spatial filtering. Charitably, you could call the performance <em>suboptimal</em>.</p>
<p><svg class="float-comp" height="144" width="144" xmlns="http://www.w3.org/2000/svg"><path d="m71.05 23.68c-26.06 0-47.27 21.22-47.27 47.27s21.22 47.27 47.27 47.27 47.27-21.22 47.27-47.27-21.22-47.27-47.27-47.27zm-.07 4.2a3.1 3.11 0 0 1 3.02 3.11 3.11 3.11 0 0 1 -6.22 0 3.11 3.11 0 0 1 3.2-3.11zm7.12 5.12a38.27 38.27 0 0 1 26.2 18.66l-3.67 8.28c-.63 1.43.02 3.11 1.44 3.75l7.06 3.13a38.27 38.27 0 0 1 .08 6.64h-3.93c-.39 0-.55.26-.55.64v1.8c0 4.24-2.39 5.17-4.49 5.4-2 .23-4.21-.84-4.49-2.06-1.18-6.63-3.14-8.04-6.24-10.49 3.85-2.44 7.85-6.05 7.85-10.87 0-5.21-3.57-8.49-6-10.1-3.42-2.25-7.2-2.7-8.22-2.7h-40.6a38.27 38.27 0 0 1 21.41-12.08l4.79 5.02c1.08 1.13 2.87 1.18 4 .09zm-44.2 23.02a3.11 3.11 0 0 1 3.02 3.11 3.11 3.11 0 0 1 -6.22 0 3.11 3.11 0 0 1 3.2-3.11zm74.15.14a3.11 3.11 0 0 1 3.02 3.11 3.11 3.11 0 0 1 -6.22 0 3.11 3.11 0 0 1 3.2-3.11zm-68.29.5h5.42v24.44h-10.94a38.27 38.27 0 0 1 -1.24-14.61l6.7-2.98c1.43-.64 2.08-2.31 1.44-3.74zm22.62.26h12.91c.67 0 4.71.77 4.71 3.8 0 2.51-3.1 3.41-5.65 3.41h-11.98zm0 17.56h9.89c.9 0 4.83.26 6.08 5.28.39 1.54 1.26 6.56 1.85 8.17.59 1.8 2.98 5.4 5.53 5.4h16.14a38.27 38.27 0 0 1 -3.54 4.1l-6.57-1.41c-1.53-.33-3.04.65-3.37 2.18l-1.56 7.28a38.27 38.27 0 0 1 -31.91-.15l-1.56-7.28c-.33-1.53-1.83-2.51-3.36-2.18l-6.43 1.38a38.27 38.27 0 0 1 -3.32-3.92h31.27c.35 0 .59-.06.59-.39v-11.06c0-.32-.24-.39-.59-.39h-9.15zm-14.43 25.33a3.11 3.11 0 0 1 3.02 3.11 3.11 3.11 0 0 1 -6.22 0 3.11 3.11 0 0 1 3.2-3.11zm46.05.14a3.11 3.11 0 0 1 3.02 3.11 3.11 3.11 0 0 1 -6.22 0 3.11 3.11 0 0 1 3.2-3.11z"/><path d="m115.68 70.95a44.63 44.63 0 0 1 -44.63 44.63 44.63 44.63 0 0 1 -44.63-44.63 44.63 44.63 0 0 1 44.63-44.63 44.63 44.63 0 0 1 44.63 44.63zm-.84-4.31 6.96 4.31-6.96 4.31 5.98 5.59-7.66 2.87 4.78 6.65-8.09 1.32 3.4 7.46-8.19-.29 1.88 7.98-7.98-1.88.29 8.19-7.46-3.4-1.32 8.09-6.65-4.78-2.87 7.66-5.59-5.98-4.31 6.96-4.31-6.96-5.59 5.98-2.87-7.66-6.65 4.78-1.32-8.09-7.46 3.4.29-8.19-7.98 1.88 1.88-7.98-8.19.29 3.4-7.46-8.09-1.32 4.78-6.65-7.66-2.87 5.98-5.59-6.96-4.31 6.96-4.31-5.98-5.59 7.66-2.87-4.78-6.65 8.09-1.32-3.4-7.46 8.19.29-1.88-7.98 7.98 1.88-.29-8.19 7.46 3.4 1.32-8.09 6.65 4.78 2.87-7.66 5.59 5.98 4.31-6.96 4.31 6.96 5.59-5.98 2.87 7.66 6.65-4.78 1.32 8.09 7.46-3.4-.29 8.19 7.98-1.88-1.88 7.98 8.19-.29-3.4 7.46 8.09 1.32-4.78 6.65 7.66 2.87z" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/></svg></p>
<p>I knew I wanted to start from scratch, since I wasn&rsquo;t interested in revisiting C++.  I picked <a href="https://www.rust-lang.org/">Rust</a>.  I&rsquo;d dabbled with it here and there, but never written anything more than a few dozen lines.  It&rsquo;s fast, fun, and has outstanding learning material.  Perfect.</p>
<p>Next, I dug through my bookmarks for <a href="https://raytracing.github.io/">Ray Tracing in One Weekend</a>, a guide by Peter Shirley on writing ray tracers.  His example code is in C++, which was great as I really didn&rsquo;t <em>want</em> to jot down someone else&rsquo;s code. Porting is way more educational.</p>
<hr>
<h2 id="the-colorful-parts">The Colorful Parts</h2>
<p>Long story short, I completed a Rust implementation of the first book of Peter Shirley&rsquo;s series.  The code is at <a href="https://github.com/mwcz/rust-raytracer-weekend">rust-raytracer-weekend</a>.  The result is a ray tracer with a movable camera, sphere intersection, three materials (diffuse, reflective, and glass), antialiasing, and bokeh.</p>
<p>I learned a lot and had a blast, and it took way longer than one weekend.  I call it: <strong>Ray Tracing in Eleven Weekends</strong></p>
<figure>
  <img loading="lazy" src="raytrace-summary-1616044535.567072104s.final-book-image-render-15hours.jpg" alt="a ray tracer render demonstrating sphere intersection, three materials (diffuse, reflective, and glass), antialiasing, and bokeh" />
  <figcaption>
    The "cover photo", demonstrating all the features of the ray tracer.
  </figcaption>
</figure>
<p>Here are some renders during development, showing the progress.  These renders demonstrate how the book starts simple, and builds up.</p>
<div class="beside">
  <figure>
    <picture>
      <source srcset="./raytrace-summary-1613153282.619191059s.ahh-a-nice-sunny-day.jxl" type="image/jxl">
      <source srcset="./raytrace-summary-1613153282.619191059s.ahh-a-nice-sunny-day.webp" type="image/webp">
      <img loading="lazy" src="raytrace-summary-1613153282.619191059s.ahh-a-nice-sunny-day.jpg" width=400 height=250 alt="A sky-colored gradient that serves as a background, and a light source." />
    </picture>
    <figcaption>A sky-colored gradient that serves as a background, and a light source.</figcaption>
  </figure>
  <figure>
    <picture>
      <source srcset="./raytrace-summary-1613154936.045811774s.ahhhh-the-blood-sun.jxl" type="image/jxl">
      <source srcset="./raytrace-summary-1613154936.045811774s.ahhhh-the-blood-sun.webp" type="image/webp">
      <img loading="lazy" src="raytrace-summary-1613154936.045811774s.ahhhh-the-blood-sun.png" alt="Sphere intersection, with a solid color." width=400 height=250/>
    </picture>
    <figcaption>Sphere intersection, with a solid color.</figcaption>
  </figure>
  <figure>
    <picture>
      <source srcset="raytrace-summary-1613156168.617724519s.oh-just-noramsl.jxl" type="image/jxl">
      <img loading="lazy" src="raytrace-summary-1613156168.617724519s.oh-just-noramsl.jpg" alt="Sphere intersection, normal vector's XYZ coords used as color." width=400 height=250 />
    </picture>
    <figcaption>Sphere intersection, normal vector's XYZ coords used as color.</figcaption>
  </figure>
  <figure>
    <picture>
      <source srcset="./raytrace-summary-1613660537.637976283s.first-with-bounces-yaaaaaay.jxl" type="image/jxl">
      <img loading="lazy" src="raytrace-summary-1613660537.637976283s.first-with-bounces-yaaaaaay.jpg" alt="Ray bouncing works, very exciting!" width=400 height=250  />
    </picture>
    <figcaption>Ray bouncing works, very exciting!</figcaption>
  </figure>
  <figure>
    <picture>
      <source srcset="./raytrace-summary-1614011092.297087907s.first-hires-render-with-clean-shadows.jxl" type="image/jxl">
      <img loading="lazy" src="raytrace-summary-1614011092.297087907s.first-hires-render-with-clean-shadows.jpg" alt="Gamma corrected and "shadow acne" cleaned up." width=630 height=394 />
    </picture>
    <figcaption>Gamma corrected and "shadow acne" cleaned up.</figcaption>
  </figure>
  <figure>
    <picture>
      <source srcset="./raytrace-summary-1615001082.58049436s.first-hires-reflective.jxl" type="image/jxl">
      <img loading="lazy" src="raytrace-summary-1615001082.58049436s.first-hires-reflective.jpg" alt="Mirror reflection." width=630 height=394  />
    </picture>
    <figcaption>Mirror reflection.</figcaption>
  </figure>
  <figure>
    <picture>
      <source srcset="raytrace-summary-1615265789.504205997s.hires-glass-and-fuzz.jxl" type="image/jxl">
      <img loading="lazy" src="raytrace-summary-1615265789.504205997s.hires-glass-and-fuzz.jpg" width=640 height=400 alt="Fuzzy reflective material and dielectric (glass)." />
    </picture>
    <figcaption>Fuzzy reflective material and dielectric (glass).</figcaption>
  </figure>
  <figure>
  <picture>
    <source srcset="./overnight-equivalent.avif" type="image/avif">
    <source srcset="./overnight-equivalent.webp" type="image/webp">
    <img src="./overnight-equivalent.jpg" alt='Perspective correction and examples of a variety of materials.' loading="lazy" width=1200 height=800 />
  </picture>
  <figcaption>Perspective correction and examples of a variety of materials.  View a <a target=_blank href="./raytrace-1616443426.236519189s-hires.jpg">hi-res original</a>.</figcaption>
  </figure>
</div>
<style>
.float-comp {
  float: right;
  shape-margin: 1em;
}
.float-comp path {
  fill: rgb(220,44,12);
  stroke: rgb(220,44,12);
}
</style>
<hr>
<h2 id="the-hard-parts">The Hard Parts</h2>
<p>It wasn&rsquo;t all candy colored pixels.  I got tripped up by Rust&rsquo;s module system, on the syntax for overloading arithmetic operators, and by the borrow checker countless times, but I think the most interesting challenge I had was with generic numbers.</p>
<h3 id="programming-with-generic-numbers">Programming with generic numbers</h3>
<p>Writing functions for handling numeric types generically was a challenge I&rsquo;d first encountered when dabbling in Rust with <a href="https://projecteuler.net/">Project Euler</a>.  For example, if I wrote a function to test whether a number was prime, I might have it accept a <code>u64</code>, but then if I want to avoid casting, I need to make sure every number I may want to test for primality must also be <code>u64</code>, as must all other functions those numbers are passed to.  That causes <code>u64</code> to spread virally through the codebase.</p>
<p>To avoid that kind of type lock-in, I wanted to try <a href="https://doc.rust-lang.org/book/ch10-01-syntax.html">Rust&rsquo;s generics</a>.  I figured there must be a way to define a function that could accept, say, &ldquo;any floating-point type&rdquo;, or &ldquo;any unsigned integer type&rdquo;, regardless of precision.</p>
<p>I set about looking for generic number <a href="https://doc.rust-lang.org/book/ch10-02-traits.html">traits</a> in the standard library and was surprised when I found none.  What I did find is the <a href="https://docs.rs/num-traits/0.2.14/num_traits/">num-traits</a> crate, a collection of &ldquo;Numeric traits for generic mathematics&rdquo;.</p>
<p>While writing this post, I noticed the lead maintainer of num-traits is fellow Red Hatter <a href="https://github.com/cuviper">Josh Stone</a>! I reached out and thanked him for his work.  I also asked if he thought generic numeric traits would ever get folded into the Rust standard library, where I&rsquo;d first gone looking.  He said:</p>
<blockquote>
<p>&ldquo;Fun fact, they <strong>came</strong> from the standard library, pre Rust 1.0.&rdquo;</p>
</blockquote>
<p>Apparently the traits had been pulled <em>out</em> of standard library in preparation for Rust 1.0 because the Rust devs weren&rsquo;t ready to stabilize them yet.  Josh has kept them stable since then.</p>
<p>He explained that stabilizing traits is tricky, because the rust compiler requires that all trait functions be implemented.  Take this pretend trait, <code>Fuzzy</code>, which pertains to the fuzziness of animals.  You can add functions with default implementations to Fuzzy all day long without causing any breaking changes for anyone using your trait.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rs" data-lang="rs"><span style="color:#66d9ef">trait</span> Fuzzy {
  <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">fuzziness</span>(<span style="color:#f92672">&amp;</span>self) -&gt; <span style="color:#66d9ef">u32</span> {
    <span style="color:#ae81ff">10</span>
  }
}
</code></pre></div><p>But this default implementation doesn&rsquo;t make sense, because an animal&rsquo;s fuzziness is individual.  It really needs to be in an <code>impl</code> so it can be specific to the animal.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rs" data-lang="rs"><span style="color:#66d9ef">trait</span> Fuzzy {
  <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">fuzziness</span>(<span style="color:#f92672">&amp;</span>self) -&gt; <span style="color:#66d9ef">u32</span>;
}

<span style="color:#75715e">// meanwhile, in a user&#39;s codebase...
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">impl</span> Fuzzy <span style="color:#66d9ef">for</span> Sheep {
}
</code></pre></div><p>Since there is no <code>impl</code> for the fuzziness function, the rust compiler emits the following error.</p>
<pre><code style="color: var(--pbp-error-color, #ff5353)">impl Fuzzy for Sheep {}
^^^^^^^^^^^^^^^^^^^^ missing `fuzziness` in implementation
</code></pre>
<p>And that&rsquo;s why numeric traits don&rsquo;t exist in the Rust standard library.</p>
<p>During this discussion it occurred to me that there could potentially be a name conflict between a function in a struct&rsquo;s impl, and a trait function implemented for that struct.  I asked Josh about this as well, and the discusison led to some <a href="https://doc.rust-lang.org/reference/expressions/call-expr.html#disambiguating-function-calls">docs on disambiguating function calls</a>.  He said that while there is some chance for name conflicts, it&rsquo;s generally not considered a breaking change because of the low liklihood, whereas adding a trait function without a default impl is guaranteed to break the builds of your users.</p>
<hr>
<h2 id="the-wordy-parts">The Wordy Parts</h2>
<p>This was a really fun project, and I could go on about what I learned for another hundred pages.  I learned a lot, got stuck a lot, got familiar with the outstanding Rust resources on offer (especially <a href="https://doc.rust-lang.org/book/">The Book</a> and <a href="https://github.com/rust-lang/rustlings">Rustlings</a>). I discovered <a href="https://www.youtube.com/channel/UC_iD0xppBwwsrM9DegC5cQQ">Jon Gjengset&rsquo;s truly excellent videos</a> too late for this project, but I&rsquo;m happily consuming them now.  He&rsquo;s a great educator.</p>
<p>This post was mostly about Rust, but the ray tracing side of the project was equally fun.  I can&rsquo;t recommend <a href="https://raytracing.github.io/">Ray Tracing in One Weekend</a> highly enough, it&rsquo;s a really accessible step-by-step guide through the principles of ray tracing.  It is <em>so exciting</em> seeing something render for the first time.</p>
<p>And a special shout out to the Rust community at Red Hat for patiently fielding my questions even though I&rsquo;m quite sure they had better things to do!</p>
<hr>
<h2 id="the-next-parts">The Next Parts</h2>
<p>The next step for the ray tracer is to compile it to WebAssembly so it can be demoed here on this very blog. <a href="https://rustwasm.github.io/wasm-pack/book/introduction.html">wasm-pack</a> makes this easy, but I will have to do some refactoring.  For example generic types aren&rsquo;t supported by <a href="https://rustwasm.github.io/docs/wasm-bindgen/">wasm-bindgen</a>, so I&rsquo;ll have to remove all the generics I so painstakingly included.  It&rsquo;s no big loss; my hobby ray tracer doesn&rsquo;t <em>need</em> generic numbers.  The value is in the learning, not in the having.</p>
<figure>
  <picture>
    <source srcset="./wasm-ferris.avif" type="image/avif">
    <img style="max-width: 400px" width="600" loading="lazy" height="378" src="./wasm-ferris.png" alt="wasm-pack logo" />
  </picture>
</figure>
<p>The next thing I&rsquo;d like to add parallelism, either with threads, SIMD, or both.  Rust promises &ldquo;fearless concurrency&rdquo;, but I&rsquo;m <em>still afraid</em>.  Or maybe it will be as simple as changing every <code>Rc</code> to <code>Arc</code>. 🌝</p>
<p>Beyond the ray tracer, the next step for me on my Rust journey is to understand <a href="https://doc.rust-lang.org/book/ch10-03-lifetime-syntax.html#lifetime-annotation-syntax">lifetime annotations</a> which came up several times during this project.  The compiler led me to a solution each time, but I didn&rsquo;t really understand the meaning of the syntax.</p>
<p>Until next time!</p>

  </section>
  <footer>

    

    

    

<section>
  <h3>RELATED POSTS</h3>
  <div class="pbp-related">
    
    <article class="pbp-article-li vertical">
  <h2 class="pbp-article-title"><a href="https://clayto.com/2017/03/meet-simpixel/">Meet SimPixel</a></h2>
  <div class="pbp-article-summary">
    <section>
      
        A WebGL-based visualizer for LED displays.
      
    </section>
  </div>
  <div class="pbp-article-meta">
    <time datetime="2017-03-10T00:00:00Z">
      Mar 10, 2017
    </time>
  </div>
  
  <a tabindex="-1" class="pbp-article-thumbnail" href="https://clayto.com/2017/03/meet-simpixel/">
    <div class="pbp-article-thumbnail">
      <div class="glass-card">
        <div class="glass-card-ratio">
          <picture>
            
            
            
               
            
            <img
              class="glass-card-bg glass-card-bg-default"
              alt="thumbnail for 'Meet SimPixel'"
              src="https://clayto.com/2017/03/meet-simpixel/./thumb.jpg">
          </picture>
          <div class="glass-card-border-outer"></div>
          <div class="glass-card-border-inner"></div>
          
          
          
          
          
        </div>
      </div>
    </div>
  </a>
  
</article>

    
    
    <article class="pbp-article-li vertical">
  <h2 class="pbp-article-title"><a href="https://clayto.com/projects/fireflies/">Fireflies</a></h2>
  <div class="pbp-article-summary">
    <section>
      
        Fireflies is a WebGL demo in which a frolicking flock of fireflies forms flying figures for your fancy.
      
    </section>
  </div>
  <div class="pbp-article-meta">
    <time datetime="2017-02-06T00:00:00Z">
      Feb 6, 2017
    </time>
  </div>
  
  <a tabindex="-1" class="pbp-article-thumbnail" href="https://clayto.com/projects/fireflies/">
    <div class="pbp-article-thumbnail">
      <div class="glass-card">
        <div class="glass-card-ratio">
          <picture>
            
            
            
               
            
            <img
              class="glass-card-bg glass-card-bg-default"
              alt="thumbnail for 'Fireflies'"
              src="https://clayto.com/projects/fireflies/./fireflies-logo.png">
          </picture>
          <div class="glass-card-border-outer"></div>
          <div class="glass-card-border-inner"></div>
          
          
          
          
          
        </div>
      </div>
    </div>
  </a>
  
</article>

    
    
    <article class="pbp-article-li vertical">
  <h2 class="pbp-article-title"><a href="https://clayto.com/projects/tracer/">Tracer</a></h2>
  <div class="pbp-article-summary">
    <section>
      
        Tracer is a 3D connect-the-dots game we created for Ludum Dare 37.
      
    </section>
  </div>
  <div class="pbp-article-meta">
    <time datetime="2017-01-25T00:00:00Z">
      Jan 25, 2017
    </time>
  </div>
  
  <a tabindex="-1" class="pbp-article-thumbnail" href="https://clayto.com/projects/tracer/">
    <div class="pbp-article-thumbnail">
      <div class="glass-card">
        <div class="glass-card-ratio">
          <picture>
            
            
            
               
            
            <img
              class="glass-card-bg glass-card-bg-default"
              alt="thumbnail for 'Tracer'"
              src="https://clayto.com/projects/tracer/./head.jpg">
          </picture>
          <div class="glass-card-border-outer"></div>
          <div class="glass-card-border-inner"></div>
          
          
          
          
          
        </div>
      </div>
    </div>
  </a>
  
</article>

    
    
    <article class="pbp-article-li vertical">
  <h2 class="pbp-article-title"><a href="https://clayto.com/2017/01/kimotion-at-geekspark-2016/">Kimotion at geekSPARK 2016</a></h2>
  <div class="pbp-article-summary">
    <section>
      
        Kimotion-powered interactive art at SPARKcon 2016.
      
    </section>
  </div>
  <div class="pbp-article-meta">
    <time datetime="2017-01-12T00:00:00Z">
      Jan 12, 2017
    </time>
  </div>
  
  <a tabindex="-1" class="pbp-article-thumbnail" href="https://clayto.com/2017/01/kimotion-at-geekspark-2016/">
    <div class="pbp-article-thumbnail">
      <div class="glass-card">
        <div class="glass-card-ratio">
          <picture>
            
            
            
               
            
            <img
              class="glass-card-bg glass-card-bg-default"
              alt="thumbnail for 'Kimotion at geekSPARK 2016'"
              src="https://clayto.com/2017/01/kimotion-at-geekspark-2016/thumb.jpg">
          </picture>
          <div class="glass-card-border-outer"></div>
          <div class="glass-card-border-inner"></div>
          
          
          
          
          
        </div>
      </div>
    </div>
  </a>
  
</article>

    
    
    <article class="pbp-article-li vertical">
  <h2 class="pbp-article-title"><a href="https://clayto.com/projects/zorbio/">Zorbio</a></h2>
  <div class="pbp-article-summary">
    <section>
      
        Zorbio is a free 3D eat-em-up game that you can <a href="https://zorb.io">play</a> in your browser!
      
    </section>
  </div>
  <div class="pbp-article-meta">
    <time datetime="2016-11-03T00:00:00Z">
      Nov 3, 2016
    </time>
  </div>
  
  <a tabindex="-1" class="pbp-article-thumbnail" href="https://clayto.com/projects/zorbio/">
    <div class="pbp-article-thumbnail">
      <div class="glass-card">
        <div class="glass-card-ratio">
          <picture>
            
            
            
               
            
            <img
              class="glass-card-bg glass-card-bg-top"
              alt="thumbnail for 'Zorbio'"
              src="https://clayto.com/projects/zorbio/./icon_zorbio.jpg">
          </picture>
          <div class="glass-card-border-outer"></div>
          <div class="glass-card-border-inner"></div>
          
          
          
          
          
        </div>
      </div>
    </div>
  </a>
  
</article>

    
    
    <article class="pbp-article-li vertical">
  <h2 class="pbp-article-title"><a href="https://clayto.com/2016/07/glow-rope/">Glow Rope</a></h2>
  <div class="pbp-article-summary">
    <section>
      
        A simple WebGL demo of streaming particles.
      
    </section>
  </div>
  <div class="pbp-article-meta">
    <time datetime="2016-07-13T00:00:00Z">
      Jul 13, 2016
    </time>
  </div>
  
  <a tabindex="-1" class="pbp-article-thumbnail" href="https://clayto.com/2016/07/glow-rope/">
    <div class="pbp-article-thumbnail">
      <div class="glass-card">
        <div class="glass-card-ratio">
          <picture>
            
            
            
               
            
            <img
              class="glass-card-bg glass-card-bg-default"
              alt="thumbnail for 'Glow Rope'"
              src="https://clayto.com/2016/07/glow-rope/thumb.jpg">
          </picture>
          <div class="glass-card-border-outer"></div>
          <div class="glass-card-border-inner"></div>
          
          
          
          
          
        </div>
      </div>
    </div>
  </a>
  
</article>

    
    
  </div>
</section>




  </footer>
</article>
  </main>
  <footer class="container">
    <section class="pbp-footer">
      
<aside>
  
    <small class="footer-label">CONTACT ME</small>
    
    
    
    
<ul class="pbp-social-links">
  
  <li>
    <a title="Email me" href="mailto:mwc@clayto.com">
      <span class="icon-mail"></span>
    </a>
  </li>
  
  
  <li>
    <a title="my GitHub activity" href="https://github.com/mwcz" target="_blank" rel="noopener">
      <span class="icon-github-squared"></span>
    </a>
  </li>
  
  
  <li>
    <a title="my CodePens" href="https://codepen.io/mwcz" target="_blank" rel="noopener">
      <span class="icon-codepen"></span>
    </a>
  </li>
  
  
  <li>
    <a title="my Twitter" href="https://twitter.com/mwcz" target="_blank" rel="noopener">
      <span class="icon-twitter-squared"></span>
    </a>
  </li>
  
  
  
  
  
  
  
  
  
  
  
  
  <li>
    <a title="my Vimeo videos" href="https://vimeo.com/mwcz" target="_blank" rel="noopener">
      <span class="icon-vimeo-squared"></span>
    </a>
  </li>
  
  
  
</ul>


  
</aside>


    </section>

    
    
    
    
    

    
    
    
    
    
    
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.1/anchor.min.js"></script>
  <script>
    anchors.options.visible = 'touch';
    anchors.options.placement = 'right';
    anchors.options.class = 'heading-anchor';
    anchors.add('article > section h1,article > section h2,article > section h3,article > section h4,article > section h5,article > section h6');
  </script>

  
    
  

</body>
</html>

